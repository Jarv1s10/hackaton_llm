{
    "site_name": "Revenue Grid Knowledge Base",
    "short_site_name": "Sfcc",
    "doc_dir": "ri/fast/articles/Impersonation-Alternative.md",
    "doc_url": "https://docs.revenuegrid.com/ri/fast/articles/Impersonation-Alternative",
    "title": null,
    "full_content": "---\ndescription: The detailed guide on Exchange Impersonation setup special scenarios for hybrid environments\n---\n# Impersonation Setup: Hybrid Scenarios  \n  \n\n<i>For users of the Email Sidebar on:</i><br><br>\n<div class=\"container\" style=\"display: inline-block; height: 42px; width: 162px; padding: 5px 10px; background-color: #fff;\"><img src=\"https://revenuegrid.com/revenue-inbox/wp-content/uploads/Exchange1.svg\" style=\"height: 100%; object-fit: contain; vertical-align: middle;\"></div><div class=\"container\" style=\"display: inline-block; height: 42px; width: 163px; padding: 5px 10px; background-color: #fff;\"><img src=\"https://revenuegrid.com/revenue-inbox/wp-content/uploads/Office365.svg\" style=\"height: 100%; object-fit: contain; vertical-align: middle;\"></div>\n\n&nbsp;\n\n*7 min read*  \n\n<!-- ShareThis BEGIN --> \n<div class=\"addthis_inline_share_toolbox\"></div>\n<!-- End ShareThis --> \n\n&nbsp;\n\n_**[the article is work-in-progress] **_\n\n&nbsp;\n\n&nbsp;\n\nThis guide is intended for Exchange Impersonation setup special scenarios for hybrid environments, where the typical scenarios for [Office 365](../Impersonation-O365/) or [MS Exchange](../Set-up-An-Impersonation-Service-Account/) cannot be applied.\n\n&nbsp;\n\nEnabling MS Exchange Impersonation for the end users consists of three stages:   \n\n**I.** Configure a Service Account and Apply it for {{ short_name }} end users as described in this article, Method 1  \n\n**II.** Verify the Configuration as described in this article  \n\n**III.** Configure Exchange Impersonation in {{ product_name }} Admin panel ([described in a separate KB article](../Setting-Up-Impersonated-Access-and-Configuring-Mailbox-Access-for-Organizations-and-Users/))  \n\n&nbsp;\n\n&nbsp;\n\n## **Step I: Configure a Service Account and Apply it for {{ short_name }} end users** \n\n!!! note \"Note\"\n    There are three methods how to set up Impersonation, Method 1 described in a [dedicated article](../Impersonation-O365/) is the recommended one, while Methods 2 and 3 in this article are only used in specific configurations\n\n&nbsp;\n\n&nbsp;\n\n### Setup Method #2 (alternative): via RBAC\n\nRequirements to configure Exchange Impersonation in your Org:\n\n\u2022     Administrative credentials for the server PC that is running Exchange 2013 - 2019 with the [Client Access server role](https://techcommunity.microsoft.com/t5/exchange-team-blog/exchange-2013-client-access-server-role/ba-p/596493)\n\n\u2022     Domain Administrator credentials, or credentials for another account type with the permission to create and assign roles and scopes\n\n\u2022     Remote [Exchange PowerShell](https://docs.microsoft.com/en-us/PowerShell/exchange/exchange-server/exchange-management-shell?view=exchange-ps) installed on the computer from which you will run the setup commands\n\n\n\n&nbsp;\n\nMicrosoft Exchange Server 2010-2019 uses [Role-Based Access Control (RBAC)](https://docs.microsoft.com/en-us/exchange/permissions-exo/permissions-exo) to assign permissions to accounts. You can use the **New-ManagementRoleAssignment** Exchange Management Shell cmdlet to assign the **ApplicationImpersonation** role to users in the organization.\n\n!!! tip \"Tip\"\n    Also refer to [this Microsoft help](https://docs.microsoft.com/en-us/exchange/understanding-management-role-scope-filters-exchange-2013-help?redirectedfrom=MSDN) article for complete information on account Roles \n\n&nbsp;\n\nWhen you assign the **ApplicationImpersonation** role, use the following parameters of the **New-ManagementRoleAssignment** cmdlet:\n\n\u2022 **Name** - The friendly name of the role assignment. Each time you assign a role, an entry is made in the RBAC roles list. You can verify role assignments by using the Get-ManagementRoleAssignment cmdlet. \n\n\u2022 **Role** - The RBAC role to assign. When you set up Exchange Impersonation, you assign the ApplicationImpersonation role.\n\n\u2022 **User** - The impersonating mail account. \n\n\u2022 **CustomRecipientScope** - The scope of users that the impersonating user can impersonate. The impersonating user will only be allowed to impersonate other users within a specified scope. If no scope is specified, the user is granted the ApplicationImpersonation role over all users in an organization. You can create custom management scopes using the New-ManagementScope cmdlet.\n\n&nbsp;\n\n&nbsp;\n\n**To configure Exchange Impersonation for a [shared mailbox](https://docs.microsoft.com/en-us/exchange/collaboration/shared-mailboxes/shared-mailboxes?view=exchserver-2019) (aliases)**\n\n**1\\.**    Create a [shared mailbox](https://docs.microsoft.com/en-us/exchange/collaboration/shared-mailboxes/shared-mailboxes?view=exchserver-2019). If there is already a shared mailbox in your Exchange, skip this step\n\n<details><summary> >>> Click to see a screenshot <<< </summary>\n<p><img src=\"..\\..\\assets\\images\\Configuration-&-Settings\\Admin-Settings-&-Actions\\Setting-Up-Impersonated-Access-in-SmartCloud-Connect-and-Configuring-Mailbox-Access-for-Organizations-and-Users\\shared-mailbox.png\" class=\"minimized\">\n</p></details> \n\n\n\n&nbsp;\n\n**2\\.** Open [Exchange Management Shell](https://docs.microsoft.com/en-us/PowerShell/exchange/exchange-server/open-the-exchange-management-shell?view=exchange-ps)\n\n&nbsp;\n\n**3\\.** Run the **New-ManagementScope** [cmdlet](https://docs.microsoft.com/en-us/exchange/collaboration/shared-mailboxes/shared-mailboxes?view=exchserver-2019) to create a scope for which the impersonation role should be assigned. If the scope was set earlier, you can skip this step. The following example shows how to create a management scope for a specific group; you can create ManagementScope only via PowerShell.\n\n*New-ManagementScope -Name:scopeName -RecipientRestrictionFilter:{Recipients Filter}*\n\nThe *RecipientRestrictionFilter* parameter of the **New-ManagementScope** [cmdlet](https://docs.microsoft.com/en-us/exchange/collaboration/shared-mailboxes/shared-mailboxes?view=exchserver-2019) defines the mailboxes in the scope. You can use properties of the **Identity** object to create the filter. \n\n&nbsp;\n\nThe following command is used to set a filter that defines the scope of mailbox aliases beginning with \"sharedmail\":\n\n```New-ManagementScope -Name SharedScopeAlias -RecipientRestrictionFilter {email alias, e.g. 'sharedmail*'}```\n\n&nbsp;\n\n**4\\.** Run the **New-ManagementRoleAssignment** [cmdlet](https://docs.microsoft.com/en-us/exchange/collaboration/shared-mailboxes/shared-mailboxes?view=exchserver-2019) to add the impersonating permissions for the mailboxes within the scope set at step ( **3** ). The following command is used to enable the service account to impersonate all users in this scope\n\n*New-ManagementRoleAssignment -Name:{Impersonation Assignment Name} -Role:ApplicationImpersonation -User:{Service Account} -CustomRecipientWriteScope:{Scope Name}*\n\n&nbsp;\n\n*For example:*\n\n``` New-ManagementRoleAssignment \u2013Name \"impersonation\" \u2013Role:ApplicationImpersonation \u2013User \"ImpersonatedAcc\" \u2013CustomRecipientWriteScope \"SharedScopeAlias\"```\n\n&nbsp;\n\nAlternatively, if your [{{ product_name }} deployment scenario](../Email-Integration-Full-Deployment-Scenarios/) requires that, you can assign the Impersonation service account for all user accounts. To do that:\n\nRun the **New-ManagementRoleAssignment** [cmdlet](https://docs.microsoft.com/en-us/PowerShell/scripting/developer/cmdlet/cmdlet-overview?view=PowerShell-6) to add impersonating permissions to the specified mail account. The following command is used to configure Exchange Impersonation enabling a service account to impersonate *all* users in an Org:  \n\n*New-ManagementRoleAssignment -Name:{impersonationAssignmentName} -Role:ApplicationImpersonation -User:{ServiceAccount}*\n\n\n&nbsp;\n\n*For example:*\n\n ```New-ManagementRoleAssignment -Name \"impersonationrole\" -Role:ApplicationImpersonation -User \"ImpersonatingAcc\"```\n\n&nbsp;\n\n&nbsp;\n\n### **To configure the management scope (via PowerShell):**\n\nGranting impersonation access to a limited set of Exchange users is more complex than granting access to all users in an Org. In Exchange this requires creation of a Management Scope which identifies the users that Impersonation will apply to. Management scopes bound to a group use the full distinguished name of the distribution group. \n\n**1\\.**  \n```$UserCredential = Get-Credential```  \n\n&nbsp;\n\n**2\\.**  \n```$Session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://outlook.office365.com/PowerShell-liveid/ -Credential $UserCredential -Authentication Basic -AllowRedirection```  \n\n&nbsp;\n\n**3\\.**  \n```Import-PSSession $Session```  \n\n&nbsp;\n\n**4\\.** Read [this article]he current Management Scopes:  \n  ```Get-ManagementScope | fl```\n\n&nbsp;\n\n**5\\.** Next, we need to get the distinguished name of the group we are  going to use, for example (using an especially createds O365 accounts group):  \n  ```$Group = Get-Group \"ManagementScopeO365Group\"```\n\n&nbsp;\n\n**6\\.** Now get the distinguished name of the group, as we will need it for the next command  \n  ```$Group.DistinguishedName```\n\n&nbsp;\nYou will see the folllowing PowerShell output:  \n\n*CN=ManagementScopeO365Group_XXXXXXXX-XXXX-XXXX-XXXXXXXXXXXX,OU=YourServer.onmicrosoft.com,OU=Microsoft Exchange Hosted Organizations,DC=NAMPR01A003,DC=prod,DC=outlook,DC=com*\n\n&nbsp;\n\n**7\\.** Create a New Management Scope:  \n\n```\nNew-ManagementScope \u2013Name \"OnePlaceMailServiceAccount\"  \u2013RecipientRestrictionFilter {MemberofGroup -eq  \"your-distinguished-group-value-here\"}\n```\n\n\nIn a sample case:\n\n```\n New-ManagementScope \u2013Name \"YourServiceAccount\"  \u2013RecipientRestrictionFilter {MemberofGroup -eq  \"CN=ManagementScopeO365Group_  XXXXXXXX-XXXX-XXXX-XXXXXXXXXXXX,OU=YourServer.onmicrosoft.com,OU=Microsoft Exchange Hosted  Organizations,DC=NAMPR01A003,DC=prod,DC=outlook,DC=com\"}\n```\n\n&nbsp;\n**8\\.** Now that we have defined a new Management Scope, we like to use by running the following command which will list out all the users that  are included in this Management Scope. This should be the users that you have added to the distribution group.  \n  ```$myMS = (Get-ManagementScope | Where-Object Name -eq \"YourServiceAccount\")```\n\n&nbsp;\n**9\\.** Enter\n  ```Get-Recipient -RecipientPreviewFilter $myMS.RecipientFilter```\n\n\n\n*Name        RecipientType*  \n\n&nbsp;\n\n*admin       UserMailbox*  \n\n*CSM_Test01  UserMailbox*  \n\n*CSM_Test02  UserMailbox* \n\n&nbsp;\n\n\n&nbsp;\n* * *\n\n&nbsp;\n\n&nbsp;\n\n### Setup Method #3 (alternative): via PowerShell\n\n\nThis guide is based on this [Microsoft help article](https://docs.microsoft.com/en-us/exchange/client-developer/exchange-web-services/how-to-configure-impersonation).\n\nThere are two ways to configure a MS Exchange Impersonated account:\n\n**I.** Using [PowerShell Exchange Management cmdlets](https://docs.microsoft.com/en-us/PowerShell/scripting/developer/cmdlet/cmdlet-overview?view=PowerShell-6):  \n\u2022\tWorks in Exchange 2016 - 2019 as well as Office 365  \n\u2022\tProvides the maximum level of account control  \n\n&nbsp;or\n\n**II.** Using [Exchange Admin Center Web UI](https://docs.microsoft.com/en-us/exchange/exchange-admin-center)\n\u2022\tWorks in Exchange 2016 - 2019 as well as in Office 365  \n\u2022\tThe easier way to go; however, allows configuring Impersonation only for **all** users in an Org  \n\n&nbsp;\n\n&nbsp;\n\n#### Set up Impersonation in Office 365 with [Exchange Online](https://docs.microsoft.com/en-us/exchange/exchange-online) using [Exchange PowerShell](https://docs.microsoft.com/en-us/PowerShell/exchange/exchange-server/exchange-management-shell)\n\n**Prerequisites:**\n\n* Administrative credentials for the Exchange server  \n* Domain Administrator credentials, or other credentials with the permission to create and assign roles and scopes  \n* Exchange management tools installed on the computer from which you will run the commands  \n  \n\n&nbsp;\n\n&nbsp;\n\n**To configure impersonation for all Exchange users in an Org:**\n\nIf you are familiar with the Windows PowerShell commands and you want  to know how to grant application impersonation rights in Office 365  using PowerShell. below steps will show how you can easily give  impersonation rights to all office 365 users of your organization with the following commands:\n\n**1\\.** Open Exchange Management Shell and click **All Programs** from the Start menu > **Microsoft Exchange Server**  \n\n&nbsp;\n\n**2\\.** Run the **New-ManagementRoleAssignment cmdlet** to  configure the impersonation permission to the required user. The  following example will show you how to grant Application impersonation  to enable a service account to impersonate all other users in an  organization.  \n\n```\nNew-ManagementRoleAssignment -name:impersonationAssignmentName -Role:ApplicationImpersonation -User:serviceAccount\n```\n\n&nbsp;\n\n&nbsp;\n\n\n\nTo assign the application impersonation role for the specific users or groups of users, you need to run the following commands.\n\n**1\\.** **Open the Exchange Management Shell** > Choose **All Programs** from the Start menu > **Microsoft Exchange Server**.  \n\n&nbsp;\n\n**2\\.** Run the **New-ManagementScope cmdlet** to create a  scope to which the impersonation role can be assigned. You can skip this  step if an existing scope is available. The following example shows how  to create a management scope for a specific group.  \n\n```\nNew-ManagementScope -Name:scopeName -RecipientRestrictionFilter:recipientFilter\n```\n\n&nbsp;\n\n**3\\.** Run the **New-ManagementRoleAssignment cmdlet** to configure the permission to impersonate the users of the specified scope.\n\n```\nNew-ManagementRoleAssignment -Name:impersonationAssignmentName  -Role:ApplicationImpersonation -User:serviceAccount  -CustomRecipientWriteScope:scopeName\n```\n\n&nbsp;\n<details><summary> >>> Click to see a screenshot <<< </summary>\n<p><img src=\"..\\..\\assets\\images\\Configuration-&-Settings\\Admin-Settings-&-Actions\\Setting-Up-Impersonated-Access-in-SmartCloud-Connect-and-Configuring-Mailbox-Access-for-Organizations-and-Users\\cloud_migration.png\" class=\"minimized\">\n</p></details>\n\n&nbsp;\n\n* * *\n\n&nbsp;\n\n\n\n## Step II: Verify the Configuration\n\n\n\nNext, you need to test the configured Impersonating account using [Microsoft Remote Connectivity Analyzer](https://techcommunity.microsoft.com/t5/exchange-team-blog/what-8217-s-new-with-microsoft-remote-connectivity-analyzer-a/ba-p/597652) online tools:\n\n**1\\.** Open the link <https://testconnectivity.microsoft.com>  \n**2\\.** Select **Service Account Access (Developers)**  \n\n<p><img src=\"..\\..\\assets\\images\\Configuration-&-Settings\\Admin-Settings-&-Actions\\Setting-Up-Impersonated-Access-in-SmartCloud-Connect-and-Configuring-Mailbox-Access-for-Organizations-and-Users\\test.png\" class=\"minimized\">\n</p>\n\n\n&nbsp;\n\n**3\\.** Fill in the details for connecting to the service account:\n\n**4\\.** **Target Mailbox address**: enter the service account's email address\n\n**5\\.** **Service Account user name**: enter the account's name using the *{domain}\\\\{user name}* or *{user}@{domain}* format\n\n**6\\.** **Service Account password** and **Confirm password** fields: enter the service account's password two times\n\n!!! note \"Note\"\n    Security of tested account's credentials entered is guaranteed by Microsoft\n\n&nbsp;\n\n**7\\.** If you are using an [Exchange Web Services URL](https://docs.microsoft.com/en-us/exchange/client-developer/exchange-web-services/start-using-web-services-in-exchange), click on \u201c**Specify Exchange Web Services URL**\u201d and enter the URL, otherwise MS Remote Connectivity Analyzer will try to discover your EWS URL automatically\n\n**8\\.** In the **Test predefined folder** field, leave the default value (*\u201cInbox\u201d*)\n\n**9\\.** Select **Use Exchange Impersonation** and under **Impersonated user** enter the email address of any user from the impersonated emails list\n\n**10\\.** If necessary in your configuration, select **Ignore Trust for SSL**\n\n**11\\.** Read and confirm the \u201c**I understand ...**\u201d section and enter the CAPTCHA to verify that you're not a robot \n\n<details><summary> >>> Click to see a screenshot <<< </summary>\n<p><img src=\"..\\..\\assets\\images\\Configuration-&-Settings\\Admin-Settings-&-Actions\\Setting-Up-Impersonated-Access-in-SmartCloud-Connect-and-Configuring-Mailbox-Access-for-Organizations-and-Users\\test2.png\" class=\"minimized\">\n</p></details> \n\n\n&nbsp;\n\n**12\\.** Click **Perform test** and check the test results to see if the Impersonated account works\n\n\n\n\n&nbsp;\n\n* * *\n\n&#160;\n\n### Step III: Configure Impersonation in {{ product_name }} Admin panel\n\nNext, proceed to [the steps provided in this article](../Setting-Up-Impersonated-Access-and-Configuring-Mailbox-Access-for-Organizations-and-Users/) to configure {{ short_name }} [Sync Engine](../Synchronization-Engine-An-Overview/) to operate via the Impersonation account.\n\n&nbsp;\n&#160;\n\n\n<style>\n  .banners {\n    text-align: center;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n  }\n\n  .banners a.button {\n      background-color: #FFC827;\n      color: #2F3341;\n      box-shadow: 0 5px 35px rgba(146, 146, 146, 0.2);\n      padding: 20px;\n      font-family: Graphic, arial;\n      font-weight: 600;\n      line-height: 24px;\n      margin-top: -100px;\n      border-radius: 3px;\n      cursor: pointer;\n      transition: .1s;\n  }\n\n  .banners a.button:hover {\n    transform: scale(1.05);\n  }\n\n  .banners a.button a:hover,\n  .banners a.button a:visited {\n      color: #2F3341;\n  }\n\n  .banner-3 a.button {\n    margin-left: 45%;\n  }\n</style>\n\n<br>\n<div class=\"banners banner-3\">\n  <img src=\"../../assets/images/banners/banner-3.svg\" style=\"width: 100%; height: 100%;\">\n  <a class=\"button\" href=\"https://revenuegrid.com/sign-up/?utm_source=kb_rg&utm_medium=referral&utm_campaign=eac&utm_content=banner\" target=\"_blank\">Try {{ company_name }} for free</a>\n</div>",
    "text_content": "description: The detailed guide on Exchange Impersonation setup special scenarios for hybrid environments\nImpersonation Setup: Hybrid Scenarios\n For users of the Email Sidebar on: \n \n \n7 min read \n \n \n \n[the article is work-in-progress] \nThis guide is intended for Exchange Impersonation setup special scenarios for hybrid environments, where the typical scenarios for Office 365 or MS Exchange cannot be applied.\nEnabling MS Exchange Impersonation for the end users consists of three stages: \nI. Configure a Service Account and Apply it for {{ short_name }} end users as described in this article, Method 1 \nII. Verify the Configuration as described in this article \nIII. Configure Exchange Impersonation in {{ product_name }} Admin panel (described in a separate KB article) \nStep I: Configure a Service Account and Apply it for {{ short_name }} end users\n!!! note \"Note\"\n There are three methods how to set up Impersonation, Method 1 described in a dedicated article is the recommended one, while Methods 2 and 3 in this article are only used in specific configurations\nSetup Method #2 (alternative): via RBAC\nRequirements to configure Exchange Impersonation in your Org:\n\u2022 Administrative credentials for the server PC that is running Exchange 2013 - 2019 with the Client Access server role\n\u2022 Domain Administrator credentials, or credentials for another account type with the permission to create and assign roles and scopes\n\u2022 Remote Exchange PowerShell installed on the computer from which you will run the setup commands\nMicrosoft Exchange Server 2010-2019 uses Role-Based Access Control (RBAC) to assign permissions to accounts. You can use the New-ManagementRoleAssignment Exchange Management Shell cmdlet to assign the ApplicationImpersonation role to users in the organization.\n!!! tip \"Tip\"\n Also refer to this Microsoft help article for complete information on account Roles \nWhen you assign the ApplicationImpersonation role, use the following parameters of the New-ManagementRoleAssignment cmdlet:\n\u2022 Name - The friendly name of the role assignment. Each time you assign a role, an entry is made in the RBAC roles list. You can verify role assignments by using the Get-ManagementRoleAssignment cmdlet. \n\u2022 Role - The RBAC role to assign. When you set up Exchange Impersonation, you assign the ApplicationImpersonation role.\n\u2022 User - The impersonating mail account. \n\u2022 CustomRecipientScope - The scope of users that the impersonating user can impersonate. The impersonating user will only be allowed to impersonate other users within a specified scope. If no scope is specified, the user is granted the ApplicationImpersonation role over all users in an organization. You can create custom management scopes using the New-ManagementScope cmdlet.\nTo configure Exchange Impersonation for a shared mailbox (aliases)\n1. Create a shared mailbox. If there is already a shared mailbox in your Exchange, skip this step\n >>> Click to see a screenshot \n \n \n2. Open Exchange Management Shell\n3. Run the New-ManagementScope cmdlet to create a scope for which the impersonation role should be assigned. If the scope was set earlier, you can skip this step. The following example shows how to create a management scope for a specific group; you can create ManagementScope only via PowerShell.\nNew-ManagementScope -Name:scopeName -RecipientRestrictionFilter:{Recipients Filter}\nThe RecipientRestrictionFilter parameter of the New-ManagementScope cmdlet defines the mailboxes in the scope. You can use properties of the Identity object to create the filter. \nThe following command is used to set a filter that defines the scope of mailbox aliases beginning with \"sharedmail\":\nNew-ManagementScope -Name SharedScopeAlias -RecipientRestrictionFilter {email alias, e.g. 'sharedmail*'}\n4. Run the New-ManagementRoleAssignment cmdlet to add the impersonating permissions for the mailboxes within the scope set at step ( 3 ). The following command is used to enable the service account to impersonate all users in this scope\nNew-ManagementRoleAssignment -Name:{Impersonation Assignment Name} -Role:ApplicationImpersonation -User:{Service Account} -CustomRecipientWriteScope:{Scope Name}\nFor example:\nNew-ManagementRoleAssignment \u2013Name \"impersonation\" \u2013Role:ApplicationImpersonation \u2013User \"ImpersonatedAcc\" \u2013CustomRecipientWriteScope \"SharedScopeAlias\"\nAlternatively, if your {{ product_name }} deployment scenario requires that, you can assign the Impersonation service account for all user accounts. To do that:\nRun the New-ManagementRoleAssignment cmdlet to add impersonating permissions to the specified mail account. The following command is used to configure Exchange Impersonation enabling a service account to impersonate all users in an Org: \nNew-ManagementRoleAssignment -Name:{impersonationAssignmentName} -Role:ApplicationImpersonation -User:{ServiceAccount}\nFor example:\nNew-ManagementRoleAssignment -Name \"impersonationrole\" -Role:ApplicationImpersonation -User \"ImpersonatingAcc\"\nTo configure the management scope (via PowerShell):\nGranting impersonation access to a limited set of Exchange users is more complex than granting access to all users in an Org. In Exchange this requires creation of a Management Scope which identifies the users that Impersonation will apply to. Management scopes bound to a group use the full distinguished name of the distribution group. \n1.\n$UserCredential = Get-Credential \n2.\n$Session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://outlook.office365.com/PowerShell-liveid/ -Credential $UserCredential -Authentication Basic -AllowRedirection \n3.\nImport-PSSession $Session \n4. Read [this article]he current Management Scopes:\nGet-ManagementScope | fl\n5. Next, we need to get the distinguished name of the group we are going to use, for example (using an especially createds O365 accounts group):\n$Group = Get-Group \"ManagementScopeO365Group\"\n6. Now get the distinguished name of the group, as we will need it for the next command\n$Group.DistinguishedName\nYou will see the folllowing PowerShell output: \nCN=ManagementScopeO365Group_XXXXXXXX-XXXX-XXXX-XXXXXXXXXXXX,OU=YourServer.onmicrosoft.com,OU=Microsoft Exchange Hosted Organizations,DC=NAMPR01A003,DC=prod,DC=outlook,DC=com\n7. Create a New Management Scope: \nNew-ManagementScope \u2013Name \"OnePlaceMailServiceAccount\" \u2013RecipientRestrictionFilter {MemberofGroup -eq \"your-distinguished-group-value-here\"}\nIn a sample case:\nNew-ManagementScope \u2013Name \"YourServiceAccount\" \u2013RecipientRestrictionFilter {MemberofGroup -eq \"CN=ManagementScopeO365Group_ XXXXXXXX-XXXX-XXXX-XXXXXXXXXXXX,OU=YourServer.onmicrosoft.com,OU=Microsoft Exchange Hosted Organizations,DC=NAMPR01A003,DC=prod,DC=outlook,DC=com\"}\n8. Now that we have defined a new Management Scope, we like to use by running the following command which will list out all the users that are included in this Management Scope. This should be the users that you have added to the distribution group.\n$myMS = (Get-ManagementScope | Where-Object Name -eq \"YourServiceAccount\")\n9. Enter\n Get-Recipient -RecipientPreviewFilter $myMS.RecipientFilter\nName RecipientType \nadmin UserMailbox \nCSM_Test01 UserMailbox \nCSM_Test02 UserMailbox \nSetup Method #3 (alternative): via PowerShell\nThis guide is based on this Microsoft help article.\nThere are two ways to configure a MS Exchange Impersonated account:\nI. Using PowerShell Exchange Management cmdlets:\n\u2022 Works in Exchange 2016 - 2019 as well as Office 365\n\u2022 Provides the maximum level of account control \nor\nII. Using Exchange Admin Center Web UI\n\u2022 Works in Exchange 2016 - 2019 as well as in Office 365\n\u2022 The easier way to go; however, allows configuring Impersonation only for all users in an Org \nSet up Impersonation in Office 365 with Exchange Online using Exchange PowerShell\nPrerequisites:\nAdministrative credentials for the Exchange server \nDomain Administrator credentials, or other credentials with the permission to create and assign roles and scopes \nExchange management tools installed on the computer from which you will run the commands \nTo configure impersonation for all Exchange users in an Org:\nIf you are familiar with the Windows PowerShell commands and you want to know how to grant application impersonation rights in Office 365 using PowerShell. below steps will show how you can easily give impersonation rights to all office 365 users of your organization with the following commands:\n1. Open Exchange Management Shell and click All Programs from the Start menu > Microsoft Exchange Server \n2. Run the New-ManagementRoleAssignment cmdlet to configure the impersonation permission to the required user. The following example will show you how to grant Application impersonation to enable a service account to impersonate all other users in an organization. \nNew-ManagementRoleAssignment -name:impersonationAssignmentName -Role:ApplicationImpersonation -User:serviceAccount\nTo assign the application impersonation role for the specific users or groups of users, you need to run the following commands.\n1. Open the Exchange Management Shell > Choose All Programs from the Start menu > Microsoft Exchange Server. \n2. Run the New-ManagementScope cmdlet to create a scope to which the impersonation role can be assigned. You can skip this step if an existing scope is available. The following example shows how to create a management scope for a specific group. \nNew-ManagementScope -Name:scopeName -RecipientRestrictionFilter:recipientFilter\n3. Run the New-ManagementRoleAssignment cmdlet to configure the permission to impersonate the users of the specified scope.\nNew-ManagementRoleAssignment -Name:impersonationAssignmentName -Role:ApplicationImpersonation -User:serviceAccount -CustomRecipientWriteScope:scopeName\n >>> Click to see a screenshot \n \n \nStep II: Verify the Configuration\nNext, you need to test the configured Impersonating account using Microsoft Remote Connectivity Analyzer online tools:\n1. Open the link https://testconnectivity.microsoft.com\n2. Select Service Account Access (Developers) \n \n \n3. Fill in the details for connecting to the service account:\n4. Target Mailbox address: enter the service account's email address\n5. Service Account user name: enter the account's name using the {domain}\\{user name} or {user}@{domain} format\n6. Service Account password and Confirm password fields: enter the service account's password two times\n!!! note \"Note\"\n Security of tested account's credentials entered is guaranteed by Microsoft\n7. If you are using an Exchange Web Services URL, click on \u201cSpecify Exchange Web Services URL\u201d and enter the URL, otherwise MS Remote Connectivity Analyzer will try to discover your EWS URL automatically\n8. In the Test predefined folder field, leave the default value (\u201cInbox\u201d)\n9. Select Use Exchange Impersonation and under Impersonated user enter the email address of any user from the impersonated emails list\n10. If necessary in your configuration, select Ignore Trust for SSL\n11. Read and confirm the \u201cI understand ...\u201d section and enter the CAPTCHA to verify that you're not a robot \n >>> Click to see a screenshot \n \n \n12. Click Perform test and check the test results to see if the Impersonated account works\n&#160;\nStep III: Configure Impersonation in {{ product_name }} Admin panel\nNext, proceed to the steps provided in this article to configure {{ short_name }} Sync Engine to operate via the Impersonation account.\n&#160;\n \n .banners {\n text-align: center;\n display: flex;\n flex-direction: column;\n align-items: center;\n }\n .banners a.button {\n background-color: #FFC827;\n color: #2F3341;\n box-shadow: 0 5px 35px rgba(146, 146, 146, 0.2);\n padding: 20px;\n font-family: Graphic, arial;\n font-weight: 600;\n line-height: 24px;\n margin-top: -100px;\n border-radius: 3px;\n cursor: pointer;\n transition: .1s;\n }\n .banners a.button:hover {\n transform: scale(1.05);\n }\n .banners a.button a:hover,\n .banners a.button a:visited {\n color: #2F3341;\n }\n .banner-3 a.button {\n margin-left: 45%;\n }\n \n \n \n \n Try {{ company_name }} for free "
}