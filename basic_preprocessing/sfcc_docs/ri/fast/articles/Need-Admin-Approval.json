{
    "site_name": "Revenue Grid Knowledge Base",
    "short_site_name": "Sfcc",
    "doc_dir": "ri/fast/articles/Need-Admin-Approval.md",
    "doc_url": "https://docs.revenuegrid.com/ri/fast/articles/Need-Admin-Approval",
    "title": null,
    "full_content": "---\ndescription: Trobleshooting: learn how to resolve the \"Need Admin Approval\" error\n---\n# How to Resolve the *Need Admin Approval* Error  \n  \n\n<i>For users of the Email Sidebar on:</i><br><br>\n<div class=\"container\" style=\"display: inline-block; height: 42px; width: 163px; padding: 5px 10px; background-color: #fff;\"><img src=\"https://revenuegrid.com/revenue-inbox/wp-content/uploads/Office365.svg\" style=\"height: 100%; object-fit: contain; vertical-align: middle;\"></div>\n\n&nbsp;\n\n*4 min read*  \n\n<!-- ShareThis BEGIN --> \n<div class=\"addthis_inline_share_toolbox\"></div>\n<!-- End ShareThis --> \n\n&nbsp;\n\nThe \"Need Admin Approval\" error may occur when a regular user attempts to get authenticated in {{ product_name }} with one's Office 365 credentials in the OAuth window:\n\n![](../assets/images/Configuration-&-Settings/Admin-Settings-&-Actions/Admin-Approval/admin-approval1.png)\n\n&nbsp;\n\n!!! warning \"Important\"\n    There is also an important server-side prerequisite to be clarified with your local Admin or [{{ short_name }} Support team](mailto:support@revenuegrid.com). To be able to authenticate access, your company's Office 365 server must have a [valid MPN ID from Microsoft](https://docs.microsoft.com/en-us/partner-center/mpn-create-a-partner-center-account). If no MPN ID is configured, {{ product_name }} App might be regarded as *unverified* and for this reason it will not be listed among access consent Apps in Admin settings. If that is the case, contact [{{ short_name }} Support team](mailto:support@revenuegrid.com) with a corresponding request\n\n\n\n\n\n\n\n&nbsp;\n\n### What causes the error\n\nThe error is caused by User permission settings in corporate [MS Azure Active Directory](https://azure.microsoft.com/en-us/services/active-directory/); specifically, the option \u201c*User can consent to apps accessing company data on their behalf*\u201d is set to \"*No*\", along with its derivative setting for accessing the groups' data. \n\nThese settings can be found in **All services** -> **Enterprise applications** -> **User settings** in MS Azure Active Directory.\n\n<details><summary> >>> Click to see a screenshot <<< </summary>\n<p><img src=\"..\\..\\assets\\images\\Configuration-&-Settings\\Admin-Settings-&-Actions\\Admin-Approval\\admin-approval2.png\" class=\"minimized\">\n</p></details>\n\n&nbsp;\n\n\n\n&nbsp;\n&nbsp;\n\n### Problem solutions\n\n&nbsp;\n\n#### Method 1\n\n##### Step 1: Grant Admin Consent for {{ product_name }}\n\n**1\\.** Log in to MS Azure AD <https://portal.azure.com> with Admin credentials  \n**2\\.** Go to **Enterprise Applications**  \n**3\\.** Select **All Applications**  \n**4\\.** Type \"*{{ company_name }}*\" in the search field to find the App and select it   \n\n<details><summary> >>> Click to see a screenshot <<< </summary>\n<p><img src=\"..\\..\\assets\\images\\Configuration-&-Settings\\Admin-Settings-&-Actions\\Admin-Approval\\admin-approval3.png\" class=\"minimized\">\n</p></details>\n\n&nbsp;\n\n!!! note \"Note\"\n    The application may be absent from the list, in case none of the users registered consent for the App previously. If  this is the case, see [Method 2](../Need-Admin-Approval/#method_2) from this article\n\n&nbsp;\n\n&nbsp;\n\n##### Step 2: Grant Admin consent\n\nAfter the Step 1 is complete, proceed to the following setup actions:\n\n**1\\.** Open the **Permissions** tab and click **Grant Admin consent for %CompanyName%**  \n<details><summary> >>> Click to see a screenshot <<< </summary>\n<p><img src=\"..\\..\\assets\\images\\Configuration-&-Settings\\Admin-Settings-&-Actions\\Admin-Approval\\admin-approval4.png\" class=\"minimized\">\n</p></details>\n&nbsp;\n\n**2\\.** Log in with O365 Admin credentials and click **Accept** in the *Permissions requested* dialog that appears\n<details><summary> >>> Click to see a screenshot <<< </summary>\n<p><img src=\"..\\..\\assets\\images\\Configuration-&-Settings\\Admin-Settings-&-Actions\\Admin-Approval\\admin-approval5.png\">\n</p></details>\n\n&nbsp;\n\n!!! note \"Note\"\n    {{ product_name }} accesses and handles the end users' email and CRM data in a most secure and private manner, according to our [Privacy and Security guarantees](https://revenuegrid.com/privacy-policy/), so approving this data access is safe\n\n&nbsp;\n\n**3\\.** Refresh the page with Permissions for the application you've just registered consent for  \n**4\\.** The list of consent permissions will be displayed in the *Admin Consent* tab on the *Applications* page   \n\n<details><summary> >>> Click to see the list of permissions <<< </summary>\n<p><table>\n<thead>\n<tr>\n<th>API Name</th>\n<th>Claim value</th>\n<th>Permission</th>\n<th>Type</th>\n<th>Granted through</th>\n<th>Granted by</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Microsoft Graph</td>\n<td></td>\n<td></td>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>Microsoft Graph</td>\n<td>profile</td>\n<td>View users\u2019 basic profile</td>\n<td>Delegated</td>\n<td>Admin consent</td>\n<td>An administrator</td>\n</tr>\n<tr>\n<td>Microsoft Graph</td>\n<td>email</td>\n<td>View users\u2019 email address</td>\n<td>Delegated</td>\n<td>Admin consent</td>\n<td>An administrator</td>\n</tr>\n<tr>\n<td>Microsoft Graph</td>\n<td>Calendars.ReadWrite</td>\n<td>Have full access to user  calendars</td>\n<td>Delegated</td>\n<td>Admin consent</td>\n<td>An administrator</td>\n</tr>\n<tr>\n<td>Microsoft Graph</td>\n<td>Mail.ReadWrite</td>\n<td>Read and write access to user mail</td>\n<td>Delegated</td>\n<td>Admin consent</td>\n<td>An administrator</td>\n</tr>\n<tr>\n<td>Microsoft Graph</td>\n<td>User.ReadEtasic.All</td>\n<td>Read all users\u2019 basic profiles</td>\n<td>Delegated</td>\n<td>Admin consent</td>\n<td>An administrator</td>\n</tr>\n<tr>\n<td>Microsoft Graph</td>\n<td>User.Read</td>\n<td>Sign in and read user profile</td>\n<td>Delegated</td>\n<td>Admin consent</td>\n<td>An administrator</td>\n</tr>\n<tr>\n<td>Microsoft Graph</td>\n<td>MailboxSettings.ReadWrite</td>\n<td>Read and write user mailbox settings</td>\n<td>Delegated</td>\n<td>Admin consent</td>\n<td>An administrator</td>\n</tr>\n<tr>\n<td>Microsoft Graph</td>\n<td>offline access</td>\n<td>Maintain  access to data you have given it access to</td>\n<td>Delegated</td>\n<td>Admin consent</td>\n<td>An  administrator</td>\n</tr>\n<tr>\n<td>Office 365 Exchange  Online</td>\n<td></td>\n<td></td>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>Office 365  Exchange Online</td>\n<td>EWS.AccessAsUser.All</td>\n<td>Access mailboxes as the signed-in user via Exchange Web Services</td>\n<td>Delegated</td>\n<td>Admin consent</td>\n<td>An administrator</td>\n</tr>\n</tbody>\n</table>\n</p></details>\n\n\n\n&nbsp;\n\n<details><summary> >>> Click to see a screenshot <<< </summary>\n<p><img src=\"..\\..\\assets\\images\\Configuration-&-Settings\\Admin-Settings-&-Actions\\Admin-Approval\\admin-approval6.png\" class=\"minimized\">\n</p></details>\n\n&nbsp;\n\nAfter that, individual users should open {{ product_name }}, click the **\u2630** (Menu) button in its upper left corner and select **Sync settings** or **Set up sync**\n\n<details><summary> >>> Click to see a screenshot <<< </summary>\n<p><img src=\"..\\..\\assets\\images\\Configuration-&-Settings\\Admin-Settings-&-Actions\\Admin-Approval\\set-up1.png\" style=\"width: 45%; height: 45%;\">\n</p></details>\n\n&nbsp;\n\nThe final setup action required from the end users is to grant access to their mailbox data when prompted in the O365 OAuth dialog. As soon as it is granted, they can start using [all {{ product_name }} functions](../AddIn-vs-Sync-Functions/).\n\n&nbsp;\n\n* * *\n\n&nbsp;\n\n#### Method 2\n\nThere is also another way to resolve the issue: the local Office 365 Admin can register consent for the App on the initial logon. This method requires the O365 Admin to be [provisioned as a {{ product_name }} user](../Managing-Users-via-the-Solution-s-Admin-Panel/).\n\nSetup actions to be performed by the Admin:\n\n**1\\.** Log in to {{ product_name }} with Salesforce credentials registered for the Admin's account  \n**2\\.** Press on the **\u2630** (Menu) button in the upper left corner of the Sidebar  \n**3\\.** Select **Set up sync** in the menu    \n\n<details><summary> >>> Click to see a screenshot <<< </summary>\n<p><img src=\"..\\..\\assets\\images\\Configuration-&-Settings\\Admin-Settings-&-Actions\\Admin-Approval\\set-upalt.png\">\n</p></details>\n&nbsp;\n\n\n\n**4\\.** Next, Log in with O365 Admin credentials in the O365 OAuth dialog that appears     \n\n\n\n**5\\.** In the following \"*Permissions Requested*\" dialog window: select the checkbox **Consent on behalf of your organization**  and click **Accept**\n\n<details><summary> >>> Click to see a screenshot <<< </summary>\n<p><img src=\"..\\..\\assets\\images\\Configuration-&-Settings\\Admin-Settings-&-Actions\\Admin-Approval\\admin-approval7.png\" class=\"minimized\">\n</p></details>\n&nbsp;\n\nAuthorization is successful, a \"*Signed in successfully*\" notification will appear. Now the consent to use the App has been granted for the whole Org and all end users in it are allowed to perform O365 data access authorization for {{ product_name }}.\n\n&nbsp;\n\n*An optional extra Step*\n\nIn case the O365 Admin does not intend to use the App, the corresponding user can be removed from {{ product_name }} via [{{ short_name }} Admin panel](../How-to-Log-In-to-the-Admin-Panel/). To do that:  \n**1\\.** Log into {{ short_company_name }} Amin UI with admin credentials  \n**2\\.** Click the **Gear** (Settings) icon in the upper right corner of the page opened  \n**3\\.** Select **Force Delete **  \n\n<details><summary> >>> Click to see a screenshot <<< </summary>\n<p><img src=\"..\\..\\assets\\images\\Configuration-&-Settings\\Admin-Settings-&-Actions\\Admin-Approval\\admin-approval8.png\" style=\"width: 70%; height: 70%;\">\n</p></details>\n\n&nbsp;\n\nAfter that check that O365 Admin user's email address was removed from [{{ product_name }} users list](../Managing-Users-via-the-Solution-s-Admin-Panel/).\n\n&nbsp;\n\n* * *\n\n&nbsp;\n\n### Method 3\n\nAnother option is to allow the end users to register consent for Apps on their own.\n\n!!! note \"Note\"\n    If this method is used, the end users will be able to register consent for any third party Apps; for some enterprises such setup might contradict general Office Apps security policies\n\n&nbsp;\n\n**1\\.** Log in to Azure AD using Admin credentials  \n**2\\.** Go to **Enterprise applications** -> **User settings **  \n**3\\.** Switch the setting \u201c*User can consent to apps accessing company data on their behalf*\u201d to **Yes ** \n\n<details><summary> >>> Click to see a screenshot <<< </summary>\n<p><img src=\"..\\..\\assets\\images\\Configuration-&-Settings\\Admin-Settings-&-Actions\\Admin-Approval\\admin-approval9.png\" class=\"minimized\">\n</p></details>\n\n&nbsp;\n\nEnabling of the setting \u201c*User can consent to apps accessing company data for the groups they own*\u201d is optional.\n\n&nbsp;\n\n&nbsp;\n\n*Also see the following articles:*  \n\n[{{ product_name }} mass deployment scenarios](../Email-Integration-Full-Deployment-Scenarios/)\n\n[How {{ product_name }} works with EWS](../Working-With-EWS/)\n\n[Microsoft Consent framework](https://docs.microsoft.com/en-us/azure/active-directory/develop/consent-framework)  \n\n[Microsoft App Consent Experience](https://docs.microsoft.com/en-us/azure/active-directory/develop/application-consent-experience)  \n\n\n<br>\n\n<style>\n  .banners {\n    text-align: center;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n  }\n\n  .banners a.button {\n      background-color: #FFC827;\n      color: #2F3341;\n      box-shadow: 0 5px 35px rgba(146, 146, 146, 0.2);\n      padding: 20px;\n      font-family: Graphic, arial;\n      font-weight: 600;\n      line-height: 24px;\n      margin-top: -80px;\n      border-radius: 3px;\n      cursor: pointer;\n      transition: .1s;\n  }\n\n  .banners a.button:hover {\n    transform: scale(1.05);\n  }\n\n  .banners a.button a:hover,\n  .banners a.button a:visited {\n      color: #2F3341;\n  }\n\n  .banner-3 a.button {\n    margin-left: 45%;\n  }\n</style>\n\n<br>\n<div class=\"banners banner-1\">\n  <img src=\"../../assets/images/banners/banner-1.svg\" style=\"width: 100%; height: 100%;\">\n  <a class=\"button\" href=\"https://revenuegrid.com/sign-up/?utm_source=kb_rg&utm_medium=referral&utm_campaign=eac&utm_content=banner\" target=\"_blank\">Sign up for a free trial</a>\n</div>\n\n\n",
    "text_content": "description: Trobleshooting: learn how to resolve the \"Need Admin Approval\" error\nHow to Resolve the Need Admin Approval Error\n For users of the Email Sidebar on: \n \n4 min read \n \n \n \nThe \"Need Admin Approval\" error may occur when a regular user attempts to get authenticated in {{ product_name }} with one's Office 365 credentials in the OAuth window:\n!!! warning \"Important\"\n There is also an important server-side prerequisite to be clarified with your local Admin or {{ short_name }} Support team. To be able to authenticate access, your company's Office 365 server must have a valid MPN ID from Microsoft. If no MPN ID is configured, {{ product_name }} App might be regarded as unverified and for this reason it will not be listed among access consent Apps in Admin settings. If that is the case, contact {{ short_name }} Support team with a corresponding request\nWhat causes the error\nThe error is caused by User permission settings in corporate MS Azure Active Directory; specifically, the option \u201cUser can consent to apps accessing company data on their behalf\u201d is set to \"No\", along with its derivative setting for accessing the groups' data. \nThese settings can be found in All services -> Enterprise applications -> User settings in MS Azure Active Directory.\n >>> Click to see a screenshot \n \n \nProblem solutions\nMethod 1\nStep 1: Grant Admin Consent for {{ product_name }}\n1. Log in to MS Azure AD https://portal.azure.com with Admin credentials\n2. Go to Enterprise Applications\n3. Select All Applications\n4. Type \"{{ company_name }}\" in the search field to find the App and select it \n >>> Click to see a screenshot \n \n \n!!! note \"Note\"\n The application may be absent from the list, in case none of the users registered consent for the App previously. If this is the case, see Method 2 from this article\nStep 2: Grant Admin consent\nAfter the Step 1 is complete, proceed to the following setup actions:\n1. Open the Permissions tab and click Grant Admin consent for %CompanyName% \n >>> Click to see a screenshot \n \n \n2. Log in with O365 Admin credentials and click Accept in the Permissions requested dialog that appears\n >>> Click to see a screenshot \n \n \n!!! note \"Note\"\n {{ product_name }} accesses and handles the end users' email and CRM data in a most secure and private manner, according to our Privacy and Security guarantees, so approving this data access is safe\n3. Refresh the page with Permissions for the application you've just registered consent for\n4. The list of consent permissions will be displayed in the Admin Consent tab on the Applications page \n >>> Click to see the list of permissions \n \n \n \n API Name \n Claim value \n Permission \n Type \n Granted through \n Granted by \n \n \n \n \n Microsoft Graph \n \n \n \n \n \n \n \n Microsoft Graph \n profile \n View users\u2019 basic profile \n Delegated \n Admin consent \n An administrator \n \n \n Microsoft Graph \n email \n View users\u2019 email address \n Delegated \n Admin consent \n An administrator \n \n \n Microsoft Graph \n Calendars.ReadWrite \n Have full access to user calendars \n Delegated \n Admin consent \n An administrator \n \n \n Microsoft Graph \n Mail.ReadWrite \n Read and write access to user mail \n Delegated \n Admin consent \n An administrator \n \n \n Microsoft Graph \n User.ReadEtasic.All \n Read all users\u2019 basic profiles \n Delegated \n Admin consent \n An administrator \n \n \n Microsoft Graph \n User.Read \n Sign in and read user profile \n Delegated \n Admin consent \n An administrator \n \n \n Microsoft Graph \n MailboxSettings.ReadWrite \n Read and write user mailbox settings \n Delegated \n Admin consent \n An administrator \n \n \n Microsoft Graph \n offline access \n Maintain access to data you have given it access to \n Delegated \n Admin consent \n An administrator \n \n \n Office 365 Exchange Online \n \n \n \n \n \n \n \n Office 365 Exchange Online \n EWS.AccessAsUser.All \n Access mailboxes as the signed-in user via Exchange Web Services \n Delegated \n Admin consent \n An administrator \n \n \n \n \n >>> Click to see a screenshot \n \n \nAfter that, individual users should open {{ product_name }}, click the \u2630 (Menu) button in its upper left corner and select Sync settings or Set up sync\n >>> Click to see a screenshot \n \n \nThe final setup action required from the end users is to grant access to their mailbox data when prompted in the O365 OAuth dialog. As soon as it is granted, they can start using all {{ product_name }} functions.\nMethod 2\nThere is also another way to resolve the issue: the local Office 365 Admin can register consent for the App on the initial logon. This method requires the O365 Admin to be provisioned as a {{ product_name }} user.\nSetup actions to be performed by the Admin:\n1. Log in to {{ product_name }} with Salesforce credentials registered for the Admin's account\n2. Press on the \u2630 (Menu) button in the upper left corner of the Sidebar\n3. Select Set up sync in the menu \n >>> Click to see a screenshot \n \n \n4. Next, Log in with O365 Admin credentials in the O365 OAuth dialog that appears \n5. In the following \"Permissions Requested\" dialog window: select the checkbox Consent on behalf of your organization and click Accept\n >>> Click to see a screenshot \n \n \nAuthorization is successful, a \"Signed in successfully\" notification will appear. Now the consent to use the App has been granted for the whole Org and all end users in it are allowed to perform O365 data access authorization for {{ product_name }}.\nAn optional extra Step\nIn case the O365 Admin does not intend to use the App, the corresponding user can be removed from {{ product_name }} via {{ short_name }} Admin panel. To do that:\n1. Log into {{ short_company_name }} Amin UI with admin credentials\n2. Click the Gear (Settings) icon in the upper right corner of the page opened\n3. Select **Force Delete ** \n >>> Click to see a screenshot \n \n \nAfter that check that O365 Admin user's email address was removed from {{ product_name }} users list.\nMethod 3\nAnother option is to allow the end users to register consent for Apps on their own.\n!!! note \"Note\"\n If this method is used, the end users will be able to register consent for any third party Apps; for some enterprises such setup might contradict general Office Apps security policies\n1. Log in to Azure AD using Admin credentials\n2. Go to Enterprise applications -> User settings \n3. Switch the setting \u201cUser can consent to apps accessing company data on their behalf\u201d to **Yes ** \n >>> Click to see a screenshot \n \n \nEnabling of the setting \u201cUser can consent to apps accessing company data for the groups they own\u201d is optional.\nAlso see the following articles: \n{{ product_name }} mass deployment scenarios\nHow {{ product_name }} works with EWS\nMicrosoft Consent framework \nMicrosoft App Consent Experience \n \n \n .banners {\n text-align: center;\n display: flex;\n flex-direction: column;\n align-items: center;\n }\n .banners a.button {\n background-color: #FFC827;\n color: #2F3341;\n box-shadow: 0 5px 35px rgba(146, 146, 146, 0.2);\n padding: 20px;\n font-family: Graphic, arial;\n font-weight: 600;\n line-height: 24px;\n margin-top: -80px;\n border-radius: 3px;\n cursor: pointer;\n transition: .1s;\n }\n .banners a.button:hover {\n transform: scale(1.05);\n }\n .banners a.button a:hover,\n .banners a.button a:visited {\n color: #2F3341;\n }\n .banner-3 a.button {\n margin-left: 45%;\n }\n \n \n \n \n Sign up for a free trial "
}