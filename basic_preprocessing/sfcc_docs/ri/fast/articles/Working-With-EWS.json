{
    "site_name": "Revenue Grid Knowledge Base",
    "short_site_name": "Sfcc",
    "doc_dir": "ri/fast/articles/Working-With-EWS.md",
    "doc_url": "https://docs.revenuegrid.com/ri/fast/articles/Working-With-EWS",
    "title": null,
    "full_content": "---\ndescription: Learn how to work with MS Exchange EWS\n---\n# How the Solution Works with MS Exchange EWS  \n  \n\n<i>For users of the Email Sidebar on:</i><br><br>\n<div class=\"container\" style=\"display: inline-block; height: 42px; width: 162px; padding: 5px 10px; background-color: #fff;\"><img src=\"https://revenuegrid.com/revenue-inbox/wp-content/uploads/Exchange1.svg\" style=\"height: 100%; object-fit: contain; vertical-align: middle;\"></div><div class=\"container\" style=\"display: inline-block; height: 42px; width: 163px; padding: 5px 10px; background-color: #fff;\"><img src=\"https://revenuegrid.com/revenue-inbox/wp-content/uploads/Office365.svg\" style=\"height: 100%; object-fit: contain; vertical-align: middle;\"></div>\n\n&nbsp;\n\n*4 min read*  \n\n<!-- ShareThis BEGIN --> \n<div class=\"addthis_inline_share_toolbox\"></div>\n<!-- End ShareThis --> \n\n&nbsp;\n\n{{ product_name }} is designed to run concurrently with other processes engaging a mail server's [Exchange Web Services (EWS)](https://docs.microsoft.com/en-us/exchange/client-developer/exchange-web-services/start-using-web-services-in-exchange) and provides the customers with the necessary controls regulating EWS access by {{ product_name }}. \n\n&nbsp; \n\n### What EWS access control tools allow:\n\n#### **Different [deployment](../Email-Integration-Full-Deployment-Scenarios/) options**\n\n{{ product_name }} supports Multi-Tenant, Single-Tenant, and On-Premise scenarios.\n\n   - These scenarios imply various levels of data and configuration isolation between tenants: logical isolation for Multi-tenant instances, physical isolation for Single-tenant instances, of full customer control for On-premise deployments\n  - As a best use practice, Multi-tenant deployment is recommended as the most cost-efficient one for an average customer, also providing a solid level of security. Other options should be considered if specific security requirements prohibit Multi-tenant operation in your Org\n\n&nbsp;\n\n#### **IP Address restrictions: {{ product_name }} operates via a fixed set of IP addresses**\n\nThe customers using corporate firewall IP address restrictions for Salesforce or MS Exchange servers connection need to allow-list specific IP addresses used by {{ product_name }}.\n\n - Such whitelisting is complementary, it does not block any existing server traffic  \n\n  - See more details on configuring IP restrictions and the list of IP addresses used in Multi-tenant environments [here](../Overcoming-Firewall-Issues/)  \n\n   - For Single-tenant configurations a specific list is communicated during {{ product_name }} deployment  \n\n  - As a best practice, such configuration should be added over the current customer configuration, to prevent interfering with existing traffic  \n\n&nbsp;\n\n#### **Filtering {{ product_name }} EWS traffic {{ product_name }}**\n\nFiltering can be configured to use a pre-set UserAgent header on every EWS call made to the customer's MS Exchange server. Such configuration allows traffic filtering on multiple levels:\n\n  - On MS Exchange / Office 365 side: using MS Exchange controls, as documented [here](https://docs.microsoft.com/en-us/exchange/client-developer/exchange-web-services/how-to-control-access-to-ews-in-exchange)\n\n     - This configuration control allows additive listing of allow-listed applications, and if used by in a customer's Org it may be extended to include traffic from/to {{ product_name }}\n\n  - By a stateful firewall which can block HTTPS traffic\n    - As in the above case, a custom rule can be built based on an added UserAgent HTTP header to allow {{ product_name }}-originated EWS traffic pass through, in addition to any other allowed traffic\n    \n  - The value of the UserAgent header for all EWS traffic can be set as requested by a customer\n\n  - As a best practice, customers who already implemented EWS traffic filtering using one of the above approaches should consider extending their configuration to allow {{ product_name }} EWS traffic\n\n&nbsp;\n\n#### **Allow EWS Access for a specific list of mailboxes only**\n\nIn some configurations, {{ product_name }} can use [Exchange Impersonation](../Setting-Up-Impersonated-Access-and-Configuring-Mailbox-Access-for-Organizations-and-Users/) and communicate with MS Exchange server through [pre-configured Service Accounts](../Impersonation-O365/). \n\n - If EWS are not used in any other way in a customer's configuration, then only specific mail accounts which need EWS access may be enabled to access them, in particular an [Impersonating account](../Setting-Up-Impersonated-Access-and-Configuring-Mailbox-Access-for-Organizations-and-Users/) set up for {{ product_name }}\n  - Refer to [this Microsoft article](https://docs.microsoft.com/en-us/exchange/client-developer/exchange-web-services/controlling-client-application-access-to-ews-in-exchange#impersonation-and-ews-access-management) for details on enabling EWS access\n  - Note that certain {{ product_name }} functions may be not supported for this configuration (e.g. the [Add-In](../Introduction/) will not be available, refer to [this article](../AddIn-vs-Sync-Functions/) for more information), [contact our CSM team](mailto:support@revenuegrid.com) for details\n\n&nbsp;\n\n##### Best practices configuration flow\n\n- Choose the {{ product_name }} deployment model that suits your Org's needs\n- Decide whether {{ product_name }} IP address filtering shall be configured in your Org\n- Decide whether {{ product_name }} EWS traffic filtering shall be configured in your Org\n- Decide which user [authentication model](../Email-Integration-Full-Deployment-Scenarios/) shall be used in your organization: whether the end users will sign in to MS Exchange or Office 365 themselves, whether [Exchange Impersonation](../Setting-Up-Impersonated-Access-and-Configuring-Mailbox-Access-for-Organizations-and-Users/) and [Service accounts](../Impersonation-O365/) will be used, and whether the {{ short_name }} [Outlook Add-In](../Introduction/) will be used; depending on that EWS access may be allowed only for a [Service account](../Impersonation-O365/) authenticating a list of end users\n\n &nbsp;\n\n#### Admin consent permissions for EWS\n\nEWS connection allows to establish MS Exchange or O365 (With Exchange Online) servers access to all data types at once: Emails, Calendar, Tasks, Contacts. The permissions set is called *EWS.AccessAsUser.All*; in contrast to [MS Graph O365 access](../MS-Graph/) EWS does <u>not</u> have a technical possibility to limit access to specific data types.  \n\n<details><summary> >>> Click to see a screenshot <<< </summary>\n<p><img src=\"..\\..\\assets\\images\\Configuration-&-Settings\\Admin-Settings-&-Actions\\API_permissions.png\" class=\"minimized\">\n</p></details>\n\n&nbsp;\n\n!!! note \"Note\"\n    Also see [this FAQ entry](../Frequently-Asked-Questions/#28_what_administrative_permissions_admin_consent_does_revenue_inbox_have_is_it_possible_to_limit_this_app_to_specific_users_or_groups_of_users_in_our_company) for more information and [this article](../Need-Admin-Approval/) to learn how to resolve the \"Need Admin Approval\" error\n\n\n&nbsp;\n\n!!! tip \"Tip\"\n    Customized data type specific access to mailboxes on O365 servers is available over MS Graph connection. See [this article](../MS-Graph/) for details\n\n&#160;\n &#160;\n\n",
    "text_content": "description: Learn how to work with MS Exchange EWS\nHow the Solution Works with MS Exchange EWS\n For users of the Email Sidebar on: \n \n \n4 min read \n \n \n \n{{ product_name }} is designed to run concurrently with other processes engaging a mail server's Exchange Web Services (EWS) and provides the customers with the necessary controls regulating EWS access by {{ product_name }}. \n \nWhat EWS access control tools allow:\nDifferent deployment options\n{{ product_name }} supports Multi-Tenant, Single-Tenant, and On-Premise scenarios.\nThese scenarios imply various levels of data and configuration isolation between tenants: logical isolation for Multi-tenant instances, physical isolation for Single-tenant instances, of full customer control for On-premise deployments\nAs a best use practice, Multi-tenant deployment is recommended as the most cost-efficient one for an average customer, also providing a solid level of security. Other options should be considered if specific security requirements prohibit Multi-tenant operation in your Org\nIP Address restrictions: {{ product_name }} operates via a fixed set of IP addresses\nThe customers using corporate firewall IP address restrictions for Salesforce or MS Exchange servers connection need to allow-list specific IP addresses used by {{ product_name }}.\nSuch whitelisting is complementary, it does not block any existing server traffic \nSee more details on configuring IP restrictions and the list of IP addresses used in Multi-tenant environments here \nFor Single-tenant configurations a specific list is communicated during {{ product_name }} deployment \nAs a best practice, such configuration should be added over the current customer configuration, to prevent interfering with existing traffic \nFiltering {{ product_name }} EWS traffic {{ product_name }}\nFiltering can be configured to use a pre-set UserAgent header on every EWS call made to the customer's MS Exchange server. Such configuration allows traffic filtering on multiple levels:\nOn MS Exchange / Office 365 side: using MS Exchange controls, as documented here\nThis configuration control allows additive listing of allow-listed applications, and if used by in a customer's Org it may be extended to include traffic from/to {{ product_name }}\nBy a stateful firewall which can block HTTPS traffic\nAs in the above case, a custom rule can be built based on an added UserAgent HTTP header to allow {{ product_name }}-originated EWS traffic pass through, in addition to any other allowed traffic\nThe value of the UserAgent header for all EWS traffic can be set as requested by a customer\nAs a best practice, customers who already implemented EWS traffic filtering using one of the above approaches should consider extending their configuration to allow {{ product_name }} EWS traffic\nAllow EWS Access for a specific list of mailboxes only\nIn some configurations, {{ product_name }} can use Exchange Impersonation and communicate with MS Exchange server through pre-configured Service Accounts. \nIf EWS are not used in any other way in a customer's configuration, then only specific mail accounts which need EWS access may be enabled to access them, in particular an Impersonating account set up for {{ product_name }}\nRefer to this Microsoft article for details on enabling EWS access\nNote that certain {{ product_name }} functions may be not supported for this configuration (e.g. the Add-In will not be available, refer to this article for more information), contact our CSM team for details\nBest practices configuration flow\nChoose the {{ product_name }} deployment model that suits your Org's needs\nDecide whether {{ product_name }} IP address filtering shall be configured in your Org\nDecide whether {{ product_name }} EWS traffic filtering shall be configured in your Org\nDecide which user authentication model shall be used in your organization: whether the end users will sign in to MS Exchange or Office 365 themselves, whether Exchange Impersonation and Service accounts will be used, and whether the {{ short_name }} Outlook Add-In will be used; depending on that EWS access may be allowed only for a Service account authenticating a list of end users\nAdmin consent permissions for EWS\nEWS connection allows to establish MS Exchange or O365 (With Exchange Online) servers access to all data types at once: Emails, Calendar, Tasks, Contacts. The permissions set is called EWS.AccessAsUser.All; in contrast to MS Graph O365 access EWS does not have a technical possibility to limit access to specific data types. \n >>> Click to see a screenshot \n \n \n!!! note \"Note\"\n Also see this FAQ entry for more information and this article to learn how to resolve the \"Need Admin Approval\" error\n!!! tip \"Tip\"\n Customized data type specific access to mailboxes on O365 servers is available over MS Graph connection. See this article for details\n&#160;\n &#160;"
}