{
    "site_name": "Revenue Grid Knowledge Base",
    "short_site_name": "Sfcc",
    "doc_dir": "ri/fast/articles/Setting-Up-Impersonated-Access-and-Configuring-Mailbox-Access-for-Organizations-and-Users.md",
    "doc_url": "https://docs.revenuegrid.com/ri/fast/articles/Setting-Up-Impersonated-Access-and-Configuring-Mailbox-Access-for-Organizations-and-Users",
    "title": null,
    "full_content": "---\ndescription: Learn how to set up sync via Impersonation & configure user mailboxes\n---\n# How to Set Up Sync via Impersonation & Configure User Mailboxes  \n  \n\n<i>For users of the Email Sidebar on:</i><br><br>\n<div class=\"container\" style=\"display: inline-block; height: 42px; width: 162px; padding: 5px 10px; background-color: #fff;\"><img src=\"https://revenuegrid.com/revenue-inbox/wp-content/uploads/Exchange1.svg\" style=\"height: 100%; object-fit: contain; vertical-align: middle;\"></div><div class=\"container\" style=\"display: inline-block; height: 42px; width: 163px; padding: 5px 10px; background-color: #fff;\"><img src=\"https://revenuegrid.com/revenue-inbox/wp-content/uploads/Office365.svg\" style=\"height: 100%; object-fit: contain; vertical-align: middle;\"></div>\n\n&nbsp;\n\n*4 min read*  \n\n<!-- ShareThis BEGIN --> \n<div class=\"addthis_inline_share_toolbox\"></div>\n<!-- End ShareThis --> \n\n&nbsp;\n\n[MS Exchange / Office 365 Impersonation](http://docs.microsoft.com/en-us/exchange/client-developer/exchange-web-services/impersonation-and-ews-in-exchange) is used in scenarios when a single admin service account is used to access and manage many end user accounts, to view or adjust their settings or perform various actions on these accounts' behalf.\nIn {{ short_name }} setup context, Impersonation allows to automatically [activate {{ company_name }} synchronization](../Authorizing-Sync-Engine-to-Work-with-Your-Data/) for all relevant email accounts in an [Organization](../Managing-Organizations-via-the-Admin-Panel/) in bulk, via an [impersonating MS Exchange service account](../Impersonation-O365/).\n\n!!! note \"Note\"\n    The Impersonation Service email account requires a dedicated MS Exchange / Office 365 mailbox license and does **not** require an additional {{ product_name }} license\n\n&nbsp;\n\nWhile Impersonation requires performing a sequence of configuration steps on Exchange server side by the local Admin (documented in detail in [this article](../Impersonation-O365/)), it has the following benefits:\n\n- There is no need for every {{ short_name }} user to enter one's Exchange/Office 365 mailbox credentials on {{ product_name }} setup. Instead, multiple users' credentials are set up once, by the local Admin  \n- The end users don't need to go to {{ product_name }} settings and [update the access password](../Renewing-Exchange-and-Salesforce-Account-Credentials/) after mailbox password change  \n- Mailbox connectivity is established and monitored entirely by the Admin, removing any associated actions from the end users\n\n!!! tip \"Tip\"\n    To check whether an Impersonation service account was configured correctly, open [this Microsoft connectivity tests page](https://testconnectivity.microsoft.com/) and run the test *Service Account Access (Developers)*, as described in [this article](../Impersonation-O365/#step_ii_verify_the_configuration)\n\n&nbsp;\n\n!!! note \"Note\"\n    If an impersonating Service account is used for [{{ company_name }} Sync users authorization](../Email-Integration-Full-Deployment-Scenarios/), the Service account must have a mailbox and a license assigned to it. If the Service Account does not have a mailbox or license assigned, [rooms and other resources](../Rooms-List/) will not be retrieved in {{ product_name }} via EWS \n\n&nbsp;\n\n&nbsp;\n\n#### Setting up {{ short_name }} Sync for multiple users via Exchange/Office 365 Impersonated Access\n\n**1\\.** Open MS Exchange or Office 365 Admin center. Refer to the following articles to learn how to do that:\n\n*   [Office 365](https://support.office.com/en-us/article/about-the-office-365-admin-center-758befc4-0888-4009-9f14-0d147402fd23)\n*   [Exchange 2016, 2019](https://technet.microsoft.com/en-us/library/jj150562(v=exchg.160).aspx)\n\n&nbsp;\n\n**2\\.** Create an MS Exchange/Office 356 service account and assign it [Impersonation permissions](https://docs.microsoft.com/en-us/exchange/client-developer/exchange-web-services/impersonation-and-ews-in-exchange) using the following step-by-step guides:\n\n* [MS Exchange](../Set-up-An-Impersonation-Service-Account/) \n* [Office 365](../Impersonation-O365/#create_a_service_account_in_office_365)\n\n\n&nbsp;\n\n**3\\.** Set up an Organization containing all relevant user mail accounts:\n\n&nbsp;&nbsp;&nbsp;&nbsp;**3.1\\.** [Log in to {{ product_name }} Admin panel](../How-to-Log-In-to-the-Admin-Panel/) (the Admin credentials are provided by [{{ company_name }} support team](mailto:support@invisble.io))\n\n&nbsp;&nbsp;&nbsp;&nbsp;**3.2\\.** [Create an Organization in {{ short_name }} Admin panel](../Managing-Organizations-via-the-Admin-Panel/#creating_organizations) [optional; for customers not fully provisioned by {{ company_name }} CSM team]\n\n&nbsp;&nbsp;&nbsp;&nbsp;**3.3\\.** [Add all relevant user accounts to the created Organization](../Managing-Organizations-via-the-Admin-Panel/#users_the_subtab_displays_the_list_of_users_which_belong_to_the_organization) [optional; for customers not fully provisioned by {{ company_name }} CSM team]\n\n&nbsp;\n\n**4.** Proceed to the instructions below to bulk-activate [{{ short_name }} Sync](../Synchronization-Engine-An-Overview/) for all relevant email accounts\n\n&nbsp;\n\n&nbsp;\n\n#### Configuring {{ short_name }} Sync Access to User Mailboxes\n\nTo bulk-activate or renew {{ short_name }} Sync access for an [Organization](../Managing-Organizations-via-the-Admin-Panel/) consisting of email accounts entitled to use {{ product_name }} for MS Exchange Impersonated access:  \n\n&nbsp;&nbsp;&nbsp;&nbsp;**4.1\\.** Go to the [Organizations tab](../Managing-Organizations-via-the-Admin-Panel/) and select the needed Organization, open the **Email Configuration** subtab  \n\n&nbsp;&nbsp;&nbsp;&nbsp;**4.2\\.** In the [**Mailbox Access Type** picklist](../Managing-Organizations-via-the-Admin-Panel/#configuring_connection_type_for_an_organization), select **Microsoft Exchange Impersonation** \n\n&nbsp;&nbsp;&nbsp;&nbsp;**4.3\\.** In the *Account Logon* field, enter the [Impersonating account's name (email address)](../Impersonation-O365/)  \n\n&nbsp;&nbsp;&nbsp;&nbsp;**4.4\\.** In the *Password* field, enter the [Impersonating account's password](../Impersonation-O365/)  \n\n&nbsp;\n\n**5\\.** In the *Exchange Web Services (EWS) URL* field, enter the [EWS URL](https://docs.microsoft.com/en-us/exchange/client-developer/exchange-web-services/start-using-web-services-in-exchange) used in your MS Exchange or click the Magic Wand icon on the right to initiate generating a standard EWS URL, if your Org doesn't use custom ones\n\n&nbsp;\n\n**6\\.** Click **Check Users Exchange Impersonated Access** to make sure the procedure was successful, then click **Save**\n\n<details><summary> >>> Click to see a screenshot <<< </summary>\n<p><img src=\"..\\..\\assets\\images\\d33v4339jhl8k0cloudfrontnet\\docs\\assets\\57398d2e903360669faf1f0a\\images\\5b1e8b030428632c466ac0ab.png\" class=\"minimized\">\n</p></details>\n\n&nbsp;\n&nbsp;\n\n* * *\n\n&nbsp;\n\n#### Service account authorization via Office 365 OAuth\n\n!!! tip \"Tip\"\n     Now this method is the only way to authorize an Exchange Impersonation service account for Office 365 mailboxes, since the old Impersonated access authorization method with login and password creds entry was removed by Microsoft in 2021 \n\n&nbsp;\n\n[MS Office 365 OAuth](https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-auth-code-flow) authentication method is used to authorize the Service account to work with {{ short_name }} end users' O365 mail data.\n\nTo do that:  \n\n&nbsp;&nbsp;&nbsp;&nbsp;**1\\.** Go to the [Organizations tab](../Managing-Organizations-via-the-Admin-Panel/) and select the needed Org configured for a group of {{ short_name }} end users. Next, open the subtab **Email Configuration** for the Org  \n\n&nbsp;&nbsp;&nbsp;&nbsp;**2\\.** In the [**Mailbox Access Type** picklist](../Managing-Organizations-via-the-Admin-Panel/#configuring_connection_type_for_an_organization), select \"*Microsoft 365 OAuth Logon (EWS API) - Impersonated logon*\", then click the button **Microsoft 365 OAuth (EWS API)** underneath   \n\n<details><summary> >>> Click to see a screenshot <<< </summary>\n<p><img src=\"..\\..\\assets\\images\\Configuration-&-Settings\\Admin-Settings-&-Actions\\o365-oauth.png\" class=\"minimized\">\n</p></details>\n\n&nbsp;\n\n&nbsp;&nbsp;&nbsp;&nbsp;**3\\.** A standard Office 365 OAuth 2.0 dialog will be opened in a new browser window. In the dialog, enter the [Impersonating account's](../Impersonation-O365/) login credentials and click **Sign In**  \n\nNow {{ product_name }} is authorized to work with mailbox data of all users configured in the Impersonating Service account.\n\n\n\n&#160;\n &#160;\n\n",
    "text_content": "description: Learn how to set up sync via Impersonation & configure user mailboxes\nHow to Set Up Sync via Impersonation & Configure User Mailboxes\n For users of the Email Sidebar on: \n \n \n4 min read \n \n \n \nMS Exchange / Office 365 Impersonation is used in scenarios when a single admin service account is used to access and manage many end user accounts, to view or adjust their settings or perform various actions on these accounts' behalf.\nIn {{ short_name }} setup context, Impersonation allows to automatically activate {{ company_name }} synchronization for all relevant email accounts in an Organization in bulk, via an impersonating MS Exchange service account.\n!!! note \"Note\"\n The Impersonation Service email account requires a dedicated MS Exchange / Office 365 mailbox license and does not require an additional {{ product_name }} license\nWhile Impersonation requires performing a sequence of configuration steps on Exchange server side by the local Admin (documented in detail in this article), it has the following benefits:\nThere is no need for every {{ short_name }} user to enter one's Exchange/Office 365 mailbox credentials on {{ product_name }} setup. Instead, multiple users' credentials are set up once, by the local Admin \nThe end users don't need to go to {{ product_name }} settings and update the access password after mailbox password change \nMailbox connectivity is established and monitored entirely by the Admin, removing any associated actions from the end users\n!!! tip \"Tip\"\n To check whether an Impersonation service account was configured correctly, open this Microsoft connectivity tests page and run the test Service Account Access (Developers), as described in this article\n!!! note \"Note\"\n If an impersonating Service account is used for {{ company_name }} Sync users authorization, the Service account must have a mailbox and a license assigned to it. If the Service Account does not have a mailbox or license assigned, rooms and other resources will not be retrieved in {{ product_name }} via EWS \nSetting up {{ short_name }} Sync for multiple users via Exchange/Office 365 Impersonated Access\n1. Open MS Exchange or Office 365 Admin center. Refer to the following articles to learn how to do that:\nOffice 365\nExchange 2016, 2019\n2. Create an MS Exchange/Office 356 service account and assign it Impersonation permissions using the following step-by-step guides:\nMS Exchange \nOffice 365\n3. Set up an Organization containing all relevant user mail accounts:\n3.1. Log in to {{ product_name }} Admin panel (the Admin credentials are provided by {{ company_name }} support team)\n3.2. Create an Organization in {{ short_name }} Admin panel [optional; for customers not fully provisioned by {{ company_name }} CSM team]\n3.3. Add all relevant user accounts to the created Organization [optional; for customers not fully provisioned by {{ company_name }} CSM team]\n4. Proceed to the instructions below to bulk-activate {{ short_name }} Sync for all relevant email accounts\nConfiguring {{ short_name }} Sync Access to User Mailboxes\nTo bulk-activate or renew {{ short_name }} Sync access for an Organization consisting of email accounts entitled to use {{ product_name }} for MS Exchange Impersonated access: \n4.1. Go to the Organizations tab and select the needed Organization, open the Email Configuration subtab \n4.2. In the Mailbox Access Type picklist, select Microsoft Exchange Impersonation \n4.3. In the Account Logon field, enter the Impersonating account's name (email address) \n4.4. In the Password field, enter the Impersonating account's password \n5. In the Exchange Web Services (EWS) URL field, enter the EWS URL used in your MS Exchange or click the Magic Wand icon on the right to initiate generating a standard EWS URL, if your Org doesn't use custom ones\n6. Click Check Users Exchange Impersonated Access to make sure the procedure was successful, then click Save\n >>> Click to see a screenshot \n \n \nService account authorization via Office 365 OAuth\n!!! tip \"Tip\"\n Now this method is the only way to authorize an Exchange Impersonation service account for Office 365 mailboxes, since the old Impersonated access authorization method with login and password creds entry was removed by Microsoft in 2021 \nMS Office 365 OAuth authentication method is used to authorize the Service account to work with {{ short_name }} end users' O365 mail data.\nTo do that: \n1. Go to the Organizations tab and select the needed Org configured for a group of {{ short_name }} end users. Next, open the subtab Email Configuration for the Org \n2. In the Mailbox Access Type picklist, select \"Microsoft 365 OAuth Logon (EWS API) - Impersonated logon\", then click the button Microsoft 365 OAuth (EWS API) underneath \n >>> Click to see a screenshot \n \n \n3. A standard Office 365 OAuth 2.0 dialog will be opened in a new browser window. In the dialog, enter the Impersonating account's login credentials and click Sign In \nNow {{ product_name }} is authorized to work with mailbox data of all users configured in the Impersonating Service account.\n&#160;\n &#160;"
}